# svm_anti_spam
使用 SVM 模型对文本进行分类，区别小广告。

用 flask 做了一层 HTTP 封装，对外提供了增加样本、对一段文本进行分类两个 API。

样本库会使用 `lib/positive.txt` `lib/negative.txt` 两个文件，可以自行修改。

### Start
1. `python manage.py initdb` 可以初始化 sqlite，将样本写入到数据库中。
2. `python manage.py run` 学习数据库中所有样本，并启动 HTTP 服务
3. `python manage.py testmodle` 可以测试模型分类的准确率

### SVM 的特征选择
先随便看几个小广告的例子：

> 发现个开放妹子视频交流群:511869833 四百多位美女每晚轮流直播表演群内每天更新十几部片！同城可约泡！关键是不要钱，进来大家一起玩，搜搜看！你会谢我的
> 来来往往的朋友！自古以来就是这么个道理：一份付出一份收-获！正如我現在一样边带孩-子边做这份工-作，现在做顺了每个玥都能进-帐五-千以上哒呦！ 公平公正，真实可靠的平台！ &召文字录入員&100-500/天  & 看一位全职妈咪的求职路从难到易之路！                  & +筘：  1 9 1 9 9 7 7 3 9 1  了解·收索出来第一个认准筘妮称：【daziyuan管-理已-认-证】 官-网已-认-证！ 温馨提示： 其它群和私人平台都是冒充本人的-切记！
> 招！小说【打字员】时间地点自由.流程简单.当天上岗月3500保底.另加提成奖金🌺🌺.2千字20元.🌺🌺4000千字=40元以此类推.🌺🌺上不封顶.工资曰结.🌺🌺加Q: 3 0 4 5 6 2 3 2 3 5 🌺🌺 了解
鉊打字，员，一千字10元。两千20元，以此类推。底新3500//无需编排，流程简单..手机---电脑---均可！企鹅：🍀321--310--522、🍀了解

可以发现几个特征：

1. 生僻字多。所以累加所有字的 unicode 16 进制编码，再做一次平均数，得到平均编码
2. 标点多会导致碎词多。单词 / 字数比例来作为特征
3. 长度。正常评论的长度不会特别长，而小广告普遍都比较长
4. 数字的个数。小广告中的 QQ 号、微信号都很多，所以数字的个数可以作为一个特征

然后我还拍脑袋的把贝叶斯的判断结果加入到了 SVM 的特征中。好不好用我也没试过＝，＝

### 测试
学习了全部的样本之后，随机挑选了 100 个进行分类

`python3 manage.py testmodle`

```
Building prefix dict from the default dictionary ...
Loading model from cache /var/folders/hz/k1d8c3w9221dqslkfk9wmcf00000gn/T/jieba.cache
Loading model cost 1.112 seconds.
Prefix dict has been built succesfully.
Predicted Result:
 [1 0 1 1 1 0 1 0 1 1 1 0 0 1 1 0 1 1 1 1 0 0 1 1 0 1 0 1 0 1 1 1 1 1 0 0 0
 1 1 1 1 1 1 0 0 1 0 1 1 1 0 1 1 1 1 1 1 1 1 1 0 1 0 1 1 1 0 1 0 0 1 0 1 1
 1 1 1 1 1 0 0 1 1 1 1 0 1 1 1 0 1 1 1 1 0 1 1 1 0 0]
Correct Result:
 [1, 0, 1, 1, 1, 0, 1, 0, 1, 1, 1, 1, 0, 1, 1, 0, 1, 1, 1, 1, 0, 0, 1, 1, 0, 1, 0, 1, 0, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 1, 1, 1, 1, 0, 0, 1, 0, 1, 1, 1, 0, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 1, 0, 1, 1, 1, 0, 1, 0, 0, 1, 0, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 0, 1, 1, 1, 1, 0, 1, 1, 1, 0, 0]
Got 96 out of 100
f1 = 0.97
```
